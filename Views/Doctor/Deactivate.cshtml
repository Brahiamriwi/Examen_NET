@model Examen_NET.Models.Doctor

@{
    ViewData["Title"] = "Desactivar Médico";
}

<h2 class="text-warning"><i class="bi bi-exclamation-triangle"></i> Desactivar Médico</h2>
<hr />

<div class="alert alert-warning">
    <h5><i class="bi bi-exclamation-triangle"></i> ¿Está seguro que desea desactivar este médico?</h5>
    <p>El médico <strong>no será eliminado</strong>, solo se marcará como inactivo. Podrá reactivarlo más tarde si es necesario.</p>
</div>

<div class="card">
    <div class="card-body">
        <dl class="row">
            <dt class="col-sm-3">Nombre Completo:</dt>
            <dd class="col-sm-9">@Model.FullName</dd>

            <dt class="col-sm-3">Documento:</dt>
            <dd class="col-sm-9">@Model.DocumentNumber</dd>

            <dt class="col-sm-3">Especialidad:</dt>
            <dd class="col-sm-9">
                <span class="badge bg-info">@Model.Specialty</span>
            </dd>

            <dt class="col-sm-3">Teléfono:</dt>
            <dd class="col-sm-9">@Model.Phone</dd>

            <dt class="col-sm-3">Email:</dt>
            <dd class="col-sm-9">@Model.Email</dd>

            <dt class="col-sm-3">Citas Registradas:</dt>
            <dd class="col-sm-9">
                @if (Model.Appointments != null && Model.Appointments.Any())
                {
                    var activeAppointments = Model.Appointments.Count(a => a.Status == "Scheduled");
                    <span class="badge bg-info">@Model.Appointments.Count() cita(s) total</span>
                    @if (activeAppointments > 0)
                    {
                        <span class="badge bg-warning">@activeAppointments programada(s)</span>
                    }
                }
                else
                {
                    <span class="text-muted">Sin citas</span>
                }
            </dd>
        </dl>

        <form asp-action="Deactivate">
            <input type="hidden" asp-for="Id" />
            @Html.AntiForgeryToken()
            <div class="d-flex gap-2">
                <button type="submit" class="btn btn-warning">
                    <i class="bi bi-x-circle"></i> Confirmar Desactivación
                </button>
                <a asp-action="Index" class="btn btn-secondary">
                    <i class="bi bi-arrow-left"></i> Cancelar
                </a>
            </div>
        </form>
    </div>
</div>

<div class="alert alert-info mt-3">
    <i class="bi bi-info-circle"></i> 
    <strong>Nota:</strong> Si el médico tiene citas programadas, no podrá ser desactivado hasta que esas citas sean canceladas o completadas.
</div>